# Dense reward configuration for Lift task
reward_mode: "dense"

# Reward type: "parallel" (all components at once) or "staged" (curriculum)
reward_type: "parallel"

# Reward weights (use negative for penalty)
weights:
  approach: 2.0        # Approach cube (fixed jaw reference point → cube center)
  approach2: 2.0       # Approach cube (moving jaw reference point → cube center)
  grasp: 1.0           # Bonus for successfully grasping the cube (binary)
  horizontal_displacement: -25.0  # Penalize cube XY displacement from initial position
  lift: 50.0           # Lift cube up (height in meters, scaled up)
  action_rate: -1.0    # Penalize action changes (anti-jitter), range ~[0, 0.2]
  success: 100.0        # Task completion bonus
  fail: -100.0         # Penalty when cube goes out of bounds

# Gated lift reward: only give lift reward when is_grasped=True
# This prevents the agent from pushing the cube up without grasping it
gate_lift_with_grasp: true

# Fixed jaw approach reward curve (piecewise linear)
# reward = 1.0 if distance < threshold
# reward = linear decay from 1.0 to 0.0 between threshold and zero_point
approach_threshold: 0.01     # Distance for full reward (1cm)
approach_zero_point: 0.20    # Distance where reward becomes 0 (20cm)

# Horizontal displacement threshold: only penalize displacement > threshold
# penalty = max(0, displacement - threshold) * weight
horizontal_displacement_threshold: 0.01  # 1cm tolerance for small movements

# Gripper reference point offsets (in meters)
# The reference point is where the cube center should be when properly grasped
gripper_tip_offset: 0.015    # Along jaw: back from tip (1.5cm)
gripper_outward_offset: 0.015  # Perpendicular: outward for cube (1.5cm)

# Moving jaw (approach2) reference point and reward curve
# Direction: local (-0.2, -1, 0.23) normalized, scale 1.8
moving_jaw_tip_offset: 0.015   # Along jaw direction: back from tip
moving_jaw_outward_offset: 0.015  # Along local -X: towards the cube center
approach2_threshold: 0.01      # Distance for full reward (1cm)
approach2_zero_point: 0.20     # Distance where reward becomes 0 (20cm)

# Lift reward height range (meters)
# lift_reward = clamp(height, 0, lift_max_height) * weight
lift_max_height: 0.10        # Cap lift reward at 10cm (no reward increase above this)

# Grasp detection parameters (for is_grasping reward gating)
grasp_min_force: 0.5         # Minimum contact force in Newtons to count as grasping
grasp_max_angle: 110         # Maximum angle (degrees) between contact force and gripper opening direction

# Success condition: cube must stay >= lift_target for stable_hold_time seconds
lift_target: 0.05           # Height threshold (5cm)
stable_hold_time: 3.0      # Required hold time in seconds (at 30Hz = 30 steps per second)

# Fail condition: cube XY must stay within this rectangle (meters)
# If cube goes outside, episode terminates with fail penalty
# Set to null or remove to disable bounds checking
fail_bounds:
  x_min: 0.35   
  x_max: 0.55
  y_min: 0.15
  y_max: 0.35

# Spawn bounds: where the red cube is randomly spawned at episode start
# If not set, uses the default grid_bounds["right"] from environment
spawn_bounds:
  x_min: 0.45
  x_max: 0.48
  y_min: 0.23
  y_max: 0.25

# Stage thresholds (for staged reward)
stages:
  approach_threshold: 0.05  # Distance to unlock next stage (5cm)
  grasp_threshold: 0.03     # Distance to consider grasped (3cm)
  lift_target: 0.05         # Height for success (5cm)
